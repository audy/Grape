#!/usr/bin/env ruby
require File.expand_path(File.join(File.dirname(__FILE__), '..', 'lib', 'grape'))

config_file = ARGV[0]
exit if config_file.nil?

g = Grape.new :config => config_file
#g.clients.each { |client| client.clean! }

puts "There are #{g.clients.length} clients."
puts "Removing dead clients"
g.remove_dead!

puts "There are #{g.clients.length} clients left."

g.setup_clients

# format database
#`./formatdb -i database/taxcollector.fa -p F`

#puts "Syncronizing Databases"
g.sync_database!

puts g.clients.first
g.clients.first.sync_folder! 'database/'
g.clients.first.run_blast \
  :query => 'queries/001.fasta', \
  :database => 'taxcollector.fa'